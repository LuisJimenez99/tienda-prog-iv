{% extends 'base.html' %} 
{% load static %} 

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/pages/lista_productos.css' %}">
{% endblock %}

{% block content %}
<div class="productos-page-wrapper">
  <h2 class="titulo-seccion">Nuestro Catálogo</h2>

  <div class="productos-page-layout">
    <aside class="filtros-sidebar">
      <h4>Filtrar por Categoría</h4>
      <ul class="lista-categorias">
        <li><a href="{% url 'lista_productos' %}">Todos</a></li>
        {% for categoria in categorias %}
        <li>
          <a href="?categoria={{ categoria.id }}">{{ categoria.nombre }}</a>
        </li>
        {% endfor %}
      </ul>
    </aside>

    <main class="productos-grid-container">
      
      {% if productos %} <div class="contenedor-grid-productos">
          
          {% for producto in productos %}
          
            {% comment %} 
              Lógica para seleccionar la plantilla de tarjeta
            {% endcomment %}
            
            {% if apariencia_config.estilo_tarjeta_producto == 'hot_sale' %}
                
                {% include 'productos/partials/card_hot_sale.html' %}
            
            {% elif apariencia_config.estilo_tarjeta_producto == 'harvest' %}

                {% comment %} Carga la nueva tarjeta Harvest {% endcomment %}
                {% include 'productos/partials/card_harvest.html' %}
            
            {% else %} 
                
                {% comment %} Este es el 'simple' (default) {% endcomment %}
                {% include 'productos/partials/card_simple.html' %}
            
            {% endif %}
            
          {% endfor %}

        </div> {% else %} <p class="no-results-msg">
            No se encontraron productos que coincidan con tu búsqueda.
          </p>

      {% endif %} {% if productos.paginator.num_pages > 1 %}
        <nav class="pagination-nav" aria-label="Navegación de páginas">
          <ul class="pagination">
            
            {% if productos.has_previous %}
              <li class="page-item">
                <a class="page-link" href="?page={{ productos.previous_page_number }}">Anterior</a>
              </li>
            {% else %}
              <li class="page-item disabled">
                <span class="page-link">Anterior</span>
              </li>
            {% endif %}

            {% for num in productos.paginator.page_range %}
              {% if productos.number == num %}
                <li class="page-item active"><span class="page-link">{{ num }}</span></li>
              {% elif num > productos.number|add:'-3' and num < productos.number|add:'3' %}
                <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
              {% endif %}
            {% endfor %}

            {% if productos.has_next %}
              <li class="page-item">
                <a class="page-link" href="?page={{ productos.next_page_number }}">Siguiente</a>
              </li>
            {% else %}
              <li class="page-item disabled">
                <span class="page-link">Siguiente</span>
              </li>
            {% endif %}

          </ul>
        </nav>
      {% endif %}
      </main> </div> </div> {% endblock %} ```